<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 게시판 처리 SQL -->
<mapper namespace="com.scit.flee2.dao.BoardMapper">
	<insert id="insertProposal" parameterType="Proposal">
	INSERT INTO WOW_PROPOSAL
	<if test="membertype=='셀러'">
	(PROPOSALNUM, ID, TITLE, INDATE, MEMBERTYPE, KEYWORD, IMAGE, COMMENTS, PRECAUTION, NAME, TYPE, CONTRACTPERIOD, PRICE, STOCK)
	VALUES
	(WOW_PROPOSAL_SEQ.NEXTVAL, #{id}, #{title}, SYSDATE, #{membertype}, #{keyword}, #{image}, #{comments}, #{precaution}, #{name}, #{type}, #{contractperiod}, #{price}, #{stock})
	</if>
	<if test="membertype=='공간제공자'">
	(PROPOSALNUM, ID, TITLE, INDATE, MEMBERTYPE, KEYWORD, IMAGE, COMMENTS, PRECAUTION, NAME, TYPE, CONTRACTPERIOD, OPTIME, OFFDAY, SCALE, SPACEADDR1, SPACEADDR2, LATITUDE, LONGITUDE)
	VALUES
	(WOW_PROPOSAL_SEQ.NEXTVAL, #{id}, #{title}, SYSDATE, #{membertype}, #{keyword}, #{image}, #{comments}, #{precaution}, #{name}, #{type}, #{contractperiod}, #{optime}, #{offday}, #{scale},  #{spaceaddr1}, #{spaceaddr2}, #{latitude}, #{longitude})
	</if>
	</insert>
	
	<select id="listProposal" parameterType="Member" resultType="Proposal">
	SELECT
	PROPOSALNUM, ID, TITLE, TO_CHAR(INDATE,'YYYY-MM-DD') AS INDATE, MEMBERTYPE, KEYWORD, COMMENTS, PRECAUTION, NAME, TYPE, CONTRACTPERIOD, PRICE, STOCK, OPTIME, OFFDAY, SCALE, SPACEADDR1, SPACEADDR2, LATITUDE, LONGITUDE
	FROM WOW_PROPOSAL
	WHERE ID=#{id}
	ORDER BY PROPOSALNUM DESC
	</select>
	
	<select id="selectProposal" parameterType="Integer" resultType="Proposal">
	SELECT
	PROPOSALNUM, ID, TITLE, TO_CHAR(INDATE,'YYYY-MM-DD') AS INDATE, MEMBERTYPE, KEYWORD, IMAGE, COMMENTS, PRECAUTION, NAME, TYPE, CONTRACTPERIOD, PRICE, STOCK, OPTIME, OFFDAY, SCALE, SPACEADDR1, SPACEADDR2, LATITUDE, LONGITUDE
	FROM WOW_PROPOSAL
	WHERE PROPOSALNUM=#{clickNo}
	</select>
	
	<update id="updateProposal" parameterType="Proposal">
	UPDATE
	WOW_PROPOSAL
	SET
		<if test="membertype=='셀러'">
		TITLE = #{title}, 
		INDATE = SYSDATE,
		KEYWORD = #{keyword}, 
		IMAGE = #{image},
		COMMENTS = #{comments}, 
		PRECAUTION = #{precaution},
		NAME = #{name}, 
		TYPE = #{type}, 
		CONTRACTPERIOD = #{contractperiod}, 
		PRICE = #{price}, 
		STOCK = #{stock}
		</if>
		<if test="membertype=='공간제공자'">
		TITLE = #{title}, 
		INDATE = SYSDATE,
		KEYWORD = #{keyword}, 
		IMAGE = #{image},
		COMMENTS = #{comments}, 
		PRECAUTION = #{precaution},
		NAME = #{name}, 
		TYPE = #{type}, 
		CONTRACTPERIOD = #{contractperiod}, 
		OPTIME = #{optime},
		OFFDAY = #{offday},
		SCALE = #{scale},
		SPACEADDR1 = #{spaceaddr1},
		SPACEADDR2 = #{spaceaddr2},
		LATITUDE = #{latitude},
		LONGITUDE = #{longitude}
		</if>
	WHERE
		PROPOSALNUM = #{proposalnum}
	</update>
	
	<update id="updateImageProp" parameterType="Proposal">
	UPDATE
	WOW_PROPOSAL
	SET
		IMAGE = #{image}
	WHERE
		PROPOSALNUM = #{proposalnum}
	</update>

	<delete id="deleteProposal" parameterType="Integer">
	DELETE
	FROM WOW_PROPOSAL
	WHERE PROPOSALNUM=#{clickNo}
	</delete>
	
	<select id="listRecommend" parameterType="String" resultType="Board">
	SELECT
	*
	FROM WOW_BOARD
	WHERE RECOMMEND='1' AND MEMBERTYPE= #{membertype}
	</select>
	
	<insert id="insertBoard" parameterType="Board">
	INSERT INTO WOW_BOARD
	<if test="membertype=='셀러'">
	(BOARDNUM, ID, TITLE, IMAGE, INDATE, MEMBERTYPE, KEYWORD, COMMENTS, PRECAUTION, NAME, TYPE, CONTRACTPERIOD, PRICE, STOCK)
	VALUES
	(WOW_BOARD_SEQ.NEXTVAL, #{id}, #{title}, #{image}, SYSDATE, #{membertype}, #{keyword}, #{comments}, #{precaution}, #{name}, #{type}, #{contractperiod}, #{price}, #{stock})
	</if>
	<if test="membertype=='공간제공자'">
	(BOARDNUM, ID, TITLE, IMAGE, INDATE, MEMBERTYPE, KEYWORD, COMMENTS, PRECAUTION, NAME, TYPE, OPTIME, OFFDAY, CONTRACTPERIOD, SCALE, SPACEADDR1, SPACEADDR2, LATITUDE, LONGITUDE)
	VALUES
	(WOW_BOARD_SEQ.NEXTVAL, #{id}, #{title}, #{image}, SYSDATE, #{membertype}, #{keyword}, #{comments}, #{precaution}, #{name}, #{type}, #{optime}, #{offday}, #{contractperiod}, #{scale}, #{spaceaddr1}, #{spaceaddr2}, #{latitude}, #{longitude})
	</if>
	</insert>
	
	<select id="listUserBoard" parameterType="Member" resultType="Board">
	SELECT
	BOARDNUM, ID, TITLE, IMAGE, TO_CHAR(INDATE,'YYYY-MM-DD') AS INDATE, MEMBERTYPE, KEYWORD, COMMENTS, PRECAUTION, NAME, TYPE, PRICE, STOCK, OPTIME, OFFDAY, SCALE, SPACEADDR1, SPACEADDR2, LATITUDE, LONGITUDE, RECOMMEND
	FROM WOW_BOARD
	WHERE ID=#{id}
	ORDER BY BOARDNUM DESC
	</select>
	
	<select id="listBoard" parameterType="String" resultType="Board">
	SELECT
	BOARDNUM, ID, TITLE, IMAGE, TO_CHAR(INDATE,'YYYY-MM-DD') AS INDATE, MEMBERTYPE, KEYWORD, COMMENTS, PRECAUTION, NAME, TYPE, PRICE, STOCK, OPTIME, OFFDAY, SCALE, SPACEADDR1, SPACEADDR2, LATITUDE, LONGITUDE, RECOMMEND
	FROM WOW_BOARD
	WHERE MEMBERTYPE=#{membertype}
	ORDER BY BOARDNUM DESC
	</select>
	
	<select id="selectBoard" parameterType="Integer" resultType="Board">
	SELECT
	*
	FROM WOW_BOARD
	WHERE BOARDNUM=#{boardnum}
	</select>
	
	<delete id="deleteBoard" parameterType="Integer">
	DELETE
	FROM WOW_BOARD
	WHERE BOARDNUM=#{clickNo}
	</delete>
	
	<insert id="insertQna" parameterType="Qna">
	INSERT INTO WOW_BOARD_QNA
	(QNANUM, BOARDNUM, COMMENTS, INDATE)
	VALUES
	(WOW_BOARD_QNA_SEQ.NEXTVAL, #{boardnum}, #{comments}, SYSDATE)
	</insert>
</mapper>
